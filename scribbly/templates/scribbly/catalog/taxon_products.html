{# A template to display all products in the given taxon #}

{% load scribbly_extras %}

{% if taxon.has_products %}
  <h2>{{ child.name }}</h2>

  <table class="table table-striped table-bordered table-condensed">
    <thead>
      <th class="span1">SKU</th>
      <th class="span2">Name</th>
      <th class="span1">RRP</th>
      <th class="span1">Discount</th>
      <th class="span1">Price</th>
      <th class="span1">On Hand</th>
      <th class="span1">Quantity</th>
    </thead>

  {% for product in taxon.get_products %}
  {% with p=priced_products|dict_lookup:product.id %}
    <tr>
      <td class=""><p>{{ p.sku }}</p></td>
      <td class="span2"><p>{{ p.name }}</p></td>
      <td class=""><p>{{ p.retail_price }}</p></td>
      <td class=""><p>{{ p.discount_as_percent_str }}</p></td>
      <td class=""><p>{{ p.discounted_price|floatformat:2 }}</p></td>
      <td class=""><span class="label">{{ p.on_hand }}</span></p></td>
      <td class="span1">


        <div class="controls">
          <div class="input-append">
            <input class="span1 input-mini" type="text" placeholder="Qty"><button class="btn btn-mini" type="button">+</button><button class="btn btn-mini" type="button">-</button>
          </div>
        </div>

      </td>
    </tr>
    {% endwith %}
    {% endfor %}
  </table>
{% endif %}


{% for child in taxon.get_children %}
  {% with taxon=child template_name="scribbly/catalog/taxon_products.html" %}
    {% include template_name %}
  {% endwith %}
{% endfor %}

